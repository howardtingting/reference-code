{"ast":null,"code":"/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _require = require('../query/GraphQLTag'),\n    getRequest = _require.getRequest;\n\nvar _require2 = require('../store/ClientID'),\n    generateUniqueClientID = _require2.generateUniqueClientID;\n\nvar isRelayModernEnvironment = require('../store/isRelayModernEnvironment');\n\nvar _require3 = require('../store/RelayModernOperationDescriptor'),\n    createOperationDescriptor = _require3.createOperationDescriptor;\n\nvar RelayDeclarativeMutationConfig = require('./RelayDeclarativeMutationConfig');\n\nvar validateMutation = require('./validateMutation');\n\nvar invariant = require('invariant');\n\nvar warning = require(\"fbjs/lib/warning\");\n/**\n * Higher-level helper function to execute a mutation against a specific\n * environment.\n */\n\n\nfunction commitMutation(environment, config) {\n  !isRelayModernEnvironment(environment) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'commitMutation: expected `environment` to be an instance of ' + '`RelayModernEnvironment`.') : invariant(false) : void 0;\n  var mutation = getRequest(config.mutation);\n\n  if (mutation.params.operationKind !== 'mutation') {\n    throw new Error('commitMutation: Expected mutation operation');\n  }\n\n  if (mutation.kind !== 'Request') {\n    throw new Error('commitMutation: Expected mutation to be of type request');\n  }\n\n  var optimisticResponse = config.optimisticResponse,\n      optimisticUpdater = config.optimisticUpdater,\n      updater = config.updater;\n  var configs = config.configs,\n      cacheConfig = config.cacheConfig,\n      onError = config.onError,\n      onUnsubscribe = config.onUnsubscribe,\n      variables = config.variables,\n      uploadables = config.uploadables;\n  var operation = createOperationDescriptor(mutation, variables, cacheConfig, generateUniqueClientID()); // TODO: remove this check after we fix flow.\n\n  if (typeof optimisticResponse === 'function') {\n    optimisticResponse = optimisticResponse();\n    process.env.NODE_ENV !== \"production\" ? warning(false, 'commitMutation: Expected `optimisticResponse` to be an object, ' + 'received a function.') : void 0;\n  }\n\n  if (process.env.NODE_ENV !== \"production\") {\n    if (optimisticResponse instanceof Object) {\n      validateMutation(optimisticResponse, mutation, variables);\n    }\n  }\n\n  if (configs) {\n    var _RelayDeclarativeMuta = RelayDeclarativeMutationConfig.convert(configs, mutation, optimisticUpdater, updater);\n\n    optimisticUpdater = _RelayDeclarativeMuta.optimisticUpdater;\n    updater = _RelayDeclarativeMuta.updater;\n  }\n\n  var errors = [];\n  var subscription = environment.executeMutation({\n    operation: operation,\n    optimisticResponse: optimisticResponse,\n    optimisticUpdater: optimisticUpdater,\n    updater: updater,\n    uploadables: uploadables\n  }).subscribe({\n    next: function next(payload) {\n      var _config$onNext;\n\n      if (Array.isArray(payload)) {\n        payload.forEach(function (item) {\n          if (item.errors) {\n            errors.push.apply(errors, (0, _toConsumableArray2[\"default\"])(item.errors));\n          }\n        });\n      } else {\n        if (payload.errors) {\n          errors.push.apply(errors, (0, _toConsumableArray2[\"default\"])(payload.errors));\n        }\n      }\n\n      (_config$onNext = config.onNext) === null || _config$onNext === void 0 ? void 0 : _config$onNext.call(config);\n    },\n    complete: function complete() {\n      var onCompleted = config.onCompleted;\n\n      if (onCompleted) {\n        var snapshot = environment.lookup(operation.fragment);\n        onCompleted(snapshot.data, errors.length !== 0 ? errors : null);\n      }\n    },\n    error: onError,\n    unsubscribe: onUnsubscribe\n  });\n  return {\n    dispose: subscription.unsubscribe\n  };\n}\n\nmodule.exports = commitMutation;","map":{"version":3,"sources":["/home/ting/Desktop/Projects/tutorials/GRAPHQL/from_react/relay_starter/node_modules/relay-runtime/lib/mutations/commitMutation.js"],"names":["_interopRequireDefault","require","_toConsumableArray2","_require","getRequest","_require2","generateUniqueClientID","isRelayModernEnvironment","_require3","createOperationDescriptor","RelayDeclarativeMutationConfig","validateMutation","invariant","warning","commitMutation","environment","config","process","env","NODE_ENV","mutation","params","operationKind","Error","kind","optimisticResponse","optimisticUpdater","updater","configs","cacheConfig","onError","onUnsubscribe","variables","uploadables","operation","Object","_RelayDeclarativeMuta","convert","errors","subscription","executeMutation","subscribe","next","payload","_config$onNext","Array","isArray","forEach","item","push","apply","onNext","call","complete","onCompleted","snapshot","lookup","fragment","data","length","error","unsubscribe","dispose","module","exports"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,8CAAD,CAApC;;AAEA,IAAIC,mBAAmB,GAAGF,sBAAsB,CAACC,OAAO,CAAC,0CAAD,CAAR,CAAhD;;AAEA,IAAIE,QAAQ,GAAGF,OAAO,CAAC,qBAAD,CAAtB;AAAA,IACIG,UAAU,GAAGD,QAAQ,CAACC,UAD1B;;AAGA,IAAIC,SAAS,GAAGJ,OAAO,CAAC,mBAAD,CAAvB;AAAA,IACIK,sBAAsB,GAAGD,SAAS,CAACC,sBADvC;;AAGA,IAAIC,wBAAwB,GAAGN,OAAO,CAAC,mCAAD,CAAtC;;AAEA,IAAIO,SAAS,GAAGP,OAAO,CAAC,yCAAD,CAAvB;AAAA,IACIQ,yBAAyB,GAAGD,SAAS,CAACC,yBAD1C;;AAGA,IAAIC,8BAA8B,GAAGT,OAAO,CAAC,kCAAD,CAA5C;;AAEA,IAAIU,gBAAgB,GAAGV,OAAO,CAAC,oBAAD,CAA9B;;AAEA,IAAIW,SAAS,GAAGX,OAAO,CAAC,WAAD,CAAvB;;AAEA,IAAIY,OAAO,GAAGZ,OAAO,CAAC,kBAAD,CAArB;AAEA;AACA;AACA;AACA;;;AACA,SAASa,cAAT,CAAwBC,WAAxB,EAAqCC,MAArC,EAA6C;AAC3C,GAACT,wBAAwB,CAACQ,WAAD,CAAzB,GAAyCE,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwCP,SAAS,CAAC,KAAD,EAAQ,iEAAiE,2BAAzE,CAAjD,GAAyJA,SAAS,CAAC,KAAD,CAA3M,GAAqN,KAAK,CAA1N;AACA,MAAIQ,QAAQ,GAAGhB,UAAU,CAACY,MAAM,CAACI,QAAR,CAAzB;;AAEA,MAAIA,QAAQ,CAACC,MAAT,CAAgBC,aAAhB,KAAkC,UAAtC,EAAkD;AAChD,UAAM,IAAIC,KAAJ,CAAU,6CAAV,CAAN;AACD;;AAED,MAAIH,QAAQ,CAACI,IAAT,KAAkB,SAAtB,EAAiC;AAC/B,UAAM,IAAID,KAAJ,CAAU,yDAAV,CAAN;AACD;;AAED,MAAIE,kBAAkB,GAAGT,MAAM,CAACS,kBAAhC;AAAA,MACIC,iBAAiB,GAAGV,MAAM,CAACU,iBAD/B;AAAA,MAEIC,OAAO,GAAGX,MAAM,CAACW,OAFrB;AAGA,MAAIC,OAAO,GAAGZ,MAAM,CAACY,OAArB;AAAA,MACIC,WAAW,GAAGb,MAAM,CAACa,WADzB;AAAA,MAEIC,OAAO,GAAGd,MAAM,CAACc,OAFrB;AAAA,MAGIC,aAAa,GAAGf,MAAM,CAACe,aAH3B;AAAA,MAIIC,SAAS,GAAGhB,MAAM,CAACgB,SAJvB;AAAA,MAKIC,WAAW,GAAGjB,MAAM,CAACiB,WALzB;AAMA,MAAIC,SAAS,GAAGzB,yBAAyB,CAACW,QAAD,EAAWY,SAAX,EAAsBH,WAAtB,EAAmCvB,sBAAsB,EAAzD,CAAzC,CArB2C,CAqB4D;;AAEvG,MAAI,OAAOmB,kBAAP,KAA8B,UAAlC,EAA8C;AAC5CA,IAAAA,kBAAkB,GAAGA,kBAAkB,EAAvC;AACAR,IAAAA,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwCN,OAAO,CAAC,KAAD,EAAQ,oEAAoE,sBAA5E,CAA/C,GAAqJ,KAAK,CAA1J;AACD;;AAED,MAAII,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACzC,QAAIM,kBAAkB,YAAYU,MAAlC,EAA0C;AACxCxB,MAAAA,gBAAgB,CAACc,kBAAD,EAAqBL,QAArB,EAA+BY,SAA/B,CAAhB;AACD;AACF;;AAED,MAAIJ,OAAJ,EAAa;AACX,QAAIQ,qBAAqB,GAAG1B,8BAA8B,CAAC2B,OAA/B,CAAuCT,OAAvC,EAAgDR,QAAhD,EAA0DM,iBAA1D,EAA6EC,OAA7E,CAA5B;;AAEAD,IAAAA,iBAAiB,GAAGU,qBAAqB,CAACV,iBAA1C;AACAC,IAAAA,OAAO,GAAGS,qBAAqB,CAACT,OAAhC;AACD;;AAED,MAAIW,MAAM,GAAG,EAAb;AACA,MAAIC,YAAY,GAAGxB,WAAW,CAACyB,eAAZ,CAA4B;AAC7CN,IAAAA,SAAS,EAAEA,SADkC;AAE7CT,IAAAA,kBAAkB,EAAEA,kBAFyB;AAG7CC,IAAAA,iBAAiB,EAAEA,iBAH0B;AAI7CC,IAAAA,OAAO,EAAEA,OAJoC;AAK7CM,IAAAA,WAAW,EAAEA;AALgC,GAA5B,EAMhBQ,SANgB,CAMN;AACXC,IAAAA,IAAI,EAAE,SAASA,IAAT,CAAcC,OAAd,EAAuB;AAC3B,UAAIC,cAAJ;;AAEA,UAAIC,KAAK,CAACC,OAAN,CAAcH,OAAd,CAAJ,EAA4B;AAC1BA,QAAAA,OAAO,CAACI,OAAR,CAAgB,UAAUC,IAAV,EAAgB;AAC9B,cAAIA,IAAI,CAACV,MAAT,EAAiB;AACfA,YAAAA,MAAM,CAACW,IAAP,CAAYC,KAAZ,CAAkBZ,MAAlB,EAA0B,CAAC,GAAGpC,mBAAmB,CAAC,SAAD,CAAvB,EAAoC8C,IAAI,CAACV,MAAzC,CAA1B;AACD;AACF,SAJD;AAKD,OAND,MAMO;AACL,YAAIK,OAAO,CAACL,MAAZ,EAAoB;AAClBA,UAAAA,MAAM,CAACW,IAAP,CAAYC,KAAZ,CAAkBZ,MAAlB,EAA0B,CAAC,GAAGpC,mBAAmB,CAAC,SAAD,CAAvB,EAAoCyC,OAAO,CAACL,MAA5C,CAA1B;AACD;AACF;;AAED,OAACM,cAAc,GAAG5B,MAAM,CAACmC,MAAzB,MAAqC,IAArC,IAA6CP,cAAc,KAAK,KAAK,CAArE,GAAyE,KAAK,CAA9E,GAAkFA,cAAc,CAACQ,IAAf,CAAoBpC,MAApB,CAAlF;AACD,KAjBU;AAkBXqC,IAAAA,QAAQ,EAAE,SAASA,QAAT,GAAoB;AAC5B,UAAIC,WAAW,GAAGtC,MAAM,CAACsC,WAAzB;;AAEA,UAAIA,WAAJ,EAAiB;AACf,YAAIC,QAAQ,GAAGxC,WAAW,CAACyC,MAAZ,CAAmBtB,SAAS,CAACuB,QAA7B,CAAf;AACAH,QAAAA,WAAW,CAACC,QAAQ,CAACG,IAAV,EAAgBpB,MAAM,CAACqB,MAAP,KAAkB,CAAlB,GAAsBrB,MAAtB,GAA+B,IAA/C,CAAX;AACD;AACF,KAzBU;AA0BXsB,IAAAA,KAAK,EAAE9B,OA1BI;AA2BX+B,IAAAA,WAAW,EAAE9B;AA3BF,GANM,CAAnB;AAmCA,SAAO;AACL+B,IAAAA,OAAO,EAAEvB,YAAY,CAACsB;AADjB,GAAP;AAGD;;AAEDE,MAAM,CAACC,OAAP,GAAiBlD,cAAjB","sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n// flowlint ambiguous-object-type:error\n'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _require = require('../query/GraphQLTag'),\n    getRequest = _require.getRequest;\n\nvar _require2 = require('../store/ClientID'),\n    generateUniqueClientID = _require2.generateUniqueClientID;\n\nvar isRelayModernEnvironment = require('../store/isRelayModernEnvironment');\n\nvar _require3 = require('../store/RelayModernOperationDescriptor'),\n    createOperationDescriptor = _require3.createOperationDescriptor;\n\nvar RelayDeclarativeMutationConfig = require('./RelayDeclarativeMutationConfig');\n\nvar validateMutation = require('./validateMutation');\n\nvar invariant = require('invariant');\n\nvar warning = require(\"fbjs/lib/warning\");\n\n/**\n * Higher-level helper function to execute a mutation against a specific\n * environment.\n */\nfunction commitMutation(environment, config) {\n  !isRelayModernEnvironment(environment) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'commitMutation: expected `environment` to be an instance of ' + '`RelayModernEnvironment`.') : invariant(false) : void 0;\n  var mutation = getRequest(config.mutation);\n\n  if (mutation.params.operationKind !== 'mutation') {\n    throw new Error('commitMutation: Expected mutation operation');\n  }\n\n  if (mutation.kind !== 'Request') {\n    throw new Error('commitMutation: Expected mutation to be of type request');\n  }\n\n  var optimisticResponse = config.optimisticResponse,\n      optimisticUpdater = config.optimisticUpdater,\n      updater = config.updater;\n  var configs = config.configs,\n      cacheConfig = config.cacheConfig,\n      onError = config.onError,\n      onUnsubscribe = config.onUnsubscribe,\n      variables = config.variables,\n      uploadables = config.uploadables;\n  var operation = createOperationDescriptor(mutation, variables, cacheConfig, generateUniqueClientID()); // TODO: remove this check after we fix flow.\n\n  if (typeof optimisticResponse === 'function') {\n    optimisticResponse = optimisticResponse();\n    process.env.NODE_ENV !== \"production\" ? warning(false, 'commitMutation: Expected `optimisticResponse` to be an object, ' + 'received a function.') : void 0;\n  }\n\n  if (process.env.NODE_ENV !== \"production\") {\n    if (optimisticResponse instanceof Object) {\n      validateMutation(optimisticResponse, mutation, variables);\n    }\n  }\n\n  if (configs) {\n    var _RelayDeclarativeMuta = RelayDeclarativeMutationConfig.convert(configs, mutation, optimisticUpdater, updater);\n\n    optimisticUpdater = _RelayDeclarativeMuta.optimisticUpdater;\n    updater = _RelayDeclarativeMuta.updater;\n  }\n\n  var errors = [];\n  var subscription = environment.executeMutation({\n    operation: operation,\n    optimisticResponse: optimisticResponse,\n    optimisticUpdater: optimisticUpdater,\n    updater: updater,\n    uploadables: uploadables\n  }).subscribe({\n    next: function next(payload) {\n      var _config$onNext;\n\n      if (Array.isArray(payload)) {\n        payload.forEach(function (item) {\n          if (item.errors) {\n            errors.push.apply(errors, (0, _toConsumableArray2[\"default\"])(item.errors));\n          }\n        });\n      } else {\n        if (payload.errors) {\n          errors.push.apply(errors, (0, _toConsumableArray2[\"default\"])(payload.errors));\n        }\n      }\n\n      (_config$onNext = config.onNext) === null || _config$onNext === void 0 ? void 0 : _config$onNext.call(config);\n    },\n    complete: function complete() {\n      var onCompleted = config.onCompleted;\n\n      if (onCompleted) {\n        var snapshot = environment.lookup(operation.fragment);\n        onCompleted(snapshot.data, errors.length !== 0 ? errors : null);\n      }\n    },\n    error: onError,\n    unsubscribe: onUnsubscribe\n  });\n  return {\n    dispose: subscription.unsubscribe\n  };\n}\n\nmodule.exports = commitMutation;"]},"metadata":{},"sourceType":"script"}